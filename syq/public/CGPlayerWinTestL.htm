<HTML style="height: 100%">
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<TITLE>CGPlayerWin</TITLE>
    <style type="text/css">
        *{
            margin: 0;padding: 0;
        }
        #CGPlayerWin1 {
            width: 625px;
        }
        .btnCon{
            line-height: 30px;
            margin-bottom: 10px;
        }
        .btnCon input{
            background-image: linear-gradient(270deg, #2674ff 0%, #33b2ff 100%);
            margin-left:8px;
            line-height: 30px;
            color: #fff;
            padding: 3px 8px;
            border: 0;
        }
    </style>
</HEAD>
<body style="height: 100%;position: relative">
<div class="btnCon">
    <input type="button" onclick="Test01();" value="兰溪水文站" />
    <input type="button" onclick="Test02();" value="女埠水尺断面" />
</div>
<OBJECT ID="CGPlayerWin" CLASSID="CLSID:888FCD0B-05BF-454E-A018-871BE4A14A91" onmousedown="haha()" width="100%" height="80%"></OBJECT>
<script type="text/javascript">
    var PTZctrl = document.getElementById("CGPlayerWin");

    function GetSDKVersion() {
            try {
                    //alert("OK");
                var ret = PTZctrl.GetSDKVersion();
                alert(ret);
            } catch (e) {
                alert(e.toString());
            }
        }

		function InitHK() {
            try {
                //alert("OK");
				var ret = PTZctrl.Init(0);
				alert(ret);
                if (ret != 0) {
					alert(ret);
                }
            } catch (e) { alert(e.toString()); }
        }
        function CleanUp() {
            try {
                var ret = PTZctrl.CleanUp();

                if (ret != 0) {
                    alert(ret);
                } else
                    alert(ret);
            } catch (e) { alert(e.toString()); }
        }

		function LoginHK() {
            try {
				//test
				var ret = PTZctrl.Login("admin", "admin12345", "172.18.19.206", 8000);//IPC
                if (ret != 0) {
					alert(ret);
                    if (ret == 30) {
                        alert("error:" + PTZctrl.GetLastError());
                    }
                }
            } catch (e) { alert(e.toString()); }
        }

        function LoginOut() {
            try {
                var ret = PTZctrl.Logout();

                if (ret != 0) {
                    alert("error:"+ret+"--detail:"+PTZctrl.GetLastError())
					if (ret == 30) {
                        alert("error:" + PTZctrl.GetLastError());
                    }
                }
            } catch (e) { alert(e.toString()); }
        }

		function PlaybyChannel(channel) {
            try {
                var ret = PTZctrl.PlayByChannel(channel);
                if (ret != 0) {
                    alert(ret);
                }
            } catch (e) { alert(e.toString()); }
        }
		function PlaybyChannel33() {
            try {
                var ret = PTZctrl.PlayByChannel(33); //first channel of IPC
                if (ret != 0) {
                    alert(ret);
                }
            } catch (e) { alert(e.toString()); }
        }
		function PlaybyChannelTestDH() {
            try {
                var ret = PTZctrl.PlayByChannel(1);
                if (ret != 0) {
                    alert(ret);
                }
            } catch (e) { alert(e.toString()); }
        }
		function PlaybyChannelTestDH2() {
            try {
                var ret = PTZctrl.PlayByChannel(2);
                if (ret != 0) {
                    alert(ret);
                }
            } catch (e) { alert(e.toString()); }
        }
		function PlaybyChannelTestDH3() {
            try {
                var ret = PTZctrl.PlayByChannel(3);
                if (ret != 0) {
                    alert(ret);
                }
            } catch (e) { alert(e.toString()); }
        }
		function PlaybyChannelTestDH4() {
            try {
                var ret = PTZctrl.PlayByChannel(34);
                if (ret != 0) {
                    alert(ret);
                }
            } catch (e) { alert(e.toString()); }
        }

		function PlaybyChannelTestDH9() {
            try {
                var ret = PTZctrl.PlayByChannel(9);
                if (ret != 0) {
                    alert(ret);
                }
            } catch (e) { alert(e.toString()); }
        }

        function StopPlay() {
            try {
                var ret = PTZctrl.StopPlay();

                if (ret != 0) {
                    alert("fail");
                }
            } catch (e) { alert(e.toString()); }
        }

		function PlayBackbyChannel() {
            try {
                    var ret = PTZctrl.startPlayBack(33, "2015-10-13 16:00:00", "2015-10-13 16:10:00");//test
					alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function replay_download() {
            try {
                //var ret = PTZctrl.ReplayDownload("74077390-455d-4957-899f-d2522690d477", "2014-08-15 9:03:00", "2014-08-15 10:00:00", "E:/Í¼Æ¬/ÊÓÆµ/ÊÓÆµ.mp4");
		 var ret = PTZctrl.ReplayDownload("7d32a4fa-ff6d-4b2f-aa14-f91b894c16fc", "2014-08-20 9:30:00", "2014-08-20 9:50:00", "E:/ÊÓÆµ/ÊÓÆµ/ÊÓÆµ2.mp4"); //¸ßÐÅ
                alert(ret);
            } catch (e) { alert(e.toString()); }
        }
 	function StopDownload() {
            try {
                var ret = PTZctrl.StopDownload();
		alert(ret);
            } catch (e) { alert(e.toString()); }
		}
        function StopPlayBack() {
            try {
                var ret = PTZctrl.stopPlayBack();
		//alert(ret);
            } catch (e) { alert(e.toString()); }
        }
        function get_replay_period() {
            try {
               // var ret = PTZctrl.GetReplayPeriod("74077390-455d-4957-899f-d2522690d477", "2014-08-1 9:03:00", "2014-08-1 10:00:00");//Åí²º
		var ret = PTZctrl.GetReplayPeriod("7d32a4fa-ff6d-4b2f-aa14-f91b894c16fc",  "2014-08-20 9:03:00", "2014-08-20 17:00:00");
                alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function set_replay_speed() {
            try {
                var ret = PTZctrl.SetPlaybackSpeed(1, 2);
				alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function ptzCreate() {
            try {
		//var ret = PTZctrl.PTZCreate("3");//ÔÝ¶¨²ÎÊýÀàÐÍ 9.29//DH test
		var ret = PTZctrl.PTZCreate("1");//HK test
            } catch (e) { alert(e.toString()); }
        }

        function ptzDestroy() {
            try {
                var ret = PTZctrl.PTZUnitialize();
            } catch (e) { alert(e.toString()); }
        }

        function Left() {
            try {
                var ret = PTZctrl.PTZLeft(60);
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function Right() {
            try {
                var ret = PTZctrl.PTZRight(60);
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function Up() {
            try {
                var ret = PTZctrl.PTZUp(60);
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function Down() {
            try {
                var ret = PTZctrl.PTZDown(60);
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function Stop() {
            try {
                var ret = PTZctrl.PTZStop();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function zoomout() {  //¶ÔÓ¦½¹¾à+
            try {
                var ret = PTZctrl.PTZZoomOut();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function zoomin() {
            try {
                var ret = PTZctrl.PTZZoomIn();//½¹¾à(in±¶ÂÊ±ä´ó.out±¶ÂÊ±äÐ¡)
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function zoomstop() {
            try {
                var ret = PTZctrl.PTZZoomStop();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function wiperclose() {
            try {
                var ret = PTZctrl.PTZWiperClose();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function wiperopen() {
            try {
                var ret = PTZctrl.PTZWiperOpen();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function lightclose() {
            try {
                var ret = PTZctrl.PTZLightClose();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function lightopen() {
            try {
                var ret = PTZctrl.PTZLightOpen();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function focusfar() {	//¶Ô½¹   ½¹µã(nearÇ°µ÷,farºóµ÷)
            try {
                var ret = PTZctrl.PTZFocusFar();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function focusnear() {
            try {
                var ret = PTZctrl.PTZFocusNear();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function focusstop() {
            try {
                var ret = PTZctrl.PTZFocusStop();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function imagelarge() {//¹âÈ¦(wide=openÀ©´ó,close=teleËõÐ¡)
            try {
                var ret = PTZctrl.PTZImageLarge();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function imagesmall() {
            try {
                var ret = PTZctrl.PTZImageSmall();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function imagestop() {
            try {
                var ret = PTZctrl.PTZImageStop();
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function SetToPreset() {
            try {
                var ret = PTZctrl.PTZSetToPreset(0);
                //alert(ret);
            } catch (e) { alert(e.toString()); }
        }

        function full() {
            try {
                var ret = PTZctrl.fullScreen();
            } catch (e) { alert(e.toString()); }
        }

        function MouseCtrl() {
            try {
                var mouseOpen;
                if (PTZctrl.MouseControl == 0) {
                    PTZctrl.MouseControl = 1;
                }
                else {
                    PTZctrl.MouseControl = 0;
                }

            } catch (e) { alert(e.toString()); }
        }

            function cap_picture() {
                try {
                    //var ret = PTZctrl.CapPicture("E:/Í¼Æ¬/ÊÓÆµ/Í¼Æ¬.png");//E:/Í¼Æ¬.png
					var d = new Date();
					var strFile = "D:/CG_Hik_CapPictureTest"+d.getTime()+".jpg";
					var ret = PTZctrl.CapPicture(strFile);
                    alert(ret);
                } catch (e) { alert(e.toString()); }
            }


		function presetAdd()
		{
			try {
                var ret = PTZctrl.PTZPresetAdd(1);
            } catch (e) { alert(e.toString()); }
		}

		function presetDel()
		{
			try {
                var ret = PTZctrl.PTZPresetDel(1);
            } catch (e) { alert(e.toString()); }
		}

		function presetMove()
		{
			try {
                var ret = PTZctrl.PTZPresetMoveTo(1);
            } catch (e) { alert(e.toString()); }
		}

		function PTZSet()
		{
			try {
                var ret = PTZctrl.PTZPosSet(33,50,50,2);//(channel,pan,tilt,zoom)
				alert(ret);
            } catch (e) { alert(e.toString()); }
		}

		function downloadByTime()
		{
			try {
                var ret = PTZctrl.startPlayBack(1, "2015-4-13 15:00:00", "2015-4-13 15:05:00");//test
				alert(ret);
            } catch (e) { alert(e.toString()); }
		}

		function SetOSD()
		{
			try {
                var ret = PTZctrl.SetOSDText(1,15,"text1\nÎÄ×Ö1\n");
				alert(ret);
            } catch (e) { alert(e.toString()); }
		}
		function SetOSD2()
		{
			try {
                var ret = PTZctrl2.SetOSDText(1,1,"PHÖµ:6.62\nÐü¸¡Îï:0\n»¯Ñ§ÐèÑõÁ¿:26.73\n°±µª:3.14\n×Üµª:0\n×ÜÁ×:0\n");
				alert(ret);
            } catch (e) { alert(e.toString()); }
		}
		function DetectActiveX()
        {
            try
            {
                var comActiveX = new ActiveXObject("CG_Player_Win.1");
            }
            catch(e)
            {
				alert("false");
               return false;
            }
			alert(true);
            return true;
        }
		function SwitchStream()
		{
			try {
                var ret = PTZctrl.SwitchBitStream();
				alert(ret);
            } catch (e) { alert(e.toString()); }
		}
		function LoginByDDNS()
		{
			try {
                //var ret = PTZctrl.LoginByDDNS("admin","12345","www.hiddns.com",80,"IP DOME","20150324CCCH508937703");
				var ret = PTZctrl.LoginByDDNS("admin","cg12344321","www.hiddns.com",80,"IP DOME","04020150804AARR533933322WCVU");//NVR
				//var ret = PTZctrl.LoginByDDNS("admin","12345","www.hiddns.com",80,"IP DOME","20150323CCCH508937448");//anfei
				//var ret = PTZctrl.LoginByDDNS("admin","12345","www.hiddns.com",80,"IP DOME","AF-YC2GD5130-A20150421CCCH514264625");

				alert(ret);
            } catch (e) { alert(e.toString()); }
		}

        function Test01()
        {
             try {
                PTZctrl.StopPlay();
                PTZctrl.Logout();
                PTZctrl.CleanUp();
                var ret = PTZctrl.Init(0);
                //alert(ret);
                var ret2 = PTZctrl.Login("admin", "admin12345", "122.226.105.30", 8000);//IPC
                if(ret2==0){
                    PTZctrl.PlaybyChannel(33);
                }

            } catch (e) { alert(e.toString()); }
        }
        function Test02()
        {
             try {
                PTZctrl.StopPlay();
                PTZctrl.Logout();
                PTZctrl.CleanUp();
                var ret = PTZctrl.Init(0);
                //alert(ret);
                var ret2 = PTZctrl.Login("admin", "admin12345", "122.227.63.206", 8000);//IPC
                if(ret2==0){
                    PTZctrl.PlaybyChannel(35);
                }

            } catch (e) { alert(e.toString()); }
        }
        function Test03()
        {
             try {
                PTZctrl.StopPlay();
                PTZctrl.Logout();
                PTZctrl.CleanUp();

            } catch (e) { alert(e.toString()); }
        }

</script>
</body>
</HTML>
